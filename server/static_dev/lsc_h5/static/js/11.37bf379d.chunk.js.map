{"version":3,"sources":["pages/mall/search_goods/index.tsx"],"names":["refreshOpt","type","mallTypes","changeMallData","payload","goodsList","SearchGoods","props","getList","obj","idx","a","match","params","typeId","typeName","goodsType","formFields","content","tabValue","page","goodsTypes","getGoodsList","getStoreList","document","title","text","storeList","url","seek","data","state","this","direction","className","name","fieldType","defaultValue","placeholder","showCancelButton","onSubmit","initValue","options","onChange","Item","onLoadData","list","goodsCategory","shareData","length","imgUrl","typeIco","medium","WxConfig","onShare","nextProps","nextState","nextContext","React","Component","connect","commonReducer","mallReducer","splice","value","dispatch","mallActions","bindActionCreators"],"mappings":"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","file":"static/js/11.37bf379d.chunk.js","sourcesContent":["import React from 'react'\r\nimport {entries} from \"reducer\";\r\nimport {mallActions,mallTypes} from \"action\";\r\nimport {bindActionCreators} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {Flex} from 'antd-mobile'\r\nimport {VsonField, VsonTabs, GoodsList, ScrollVertical, BackHome, StoreList} from 'components'\r\nimport {WxConfig} from 'utils'\r\nimport './index.scss'\r\n\r\nexport interface P {\r\n    page: number,\r\n    changeMallData: any,\r\n    getGoodsList: any,\r\n    getStoreList: any,\r\n    formFields: any,\r\n    match: any,\r\n    goodsType: number,\r\n    goodsTypes: any[],\r\n    goodsList: any[],\r\n    storeList: any[]\r\n}\r\n\r\n\r\nconst refreshOpt = {\r\n    type: mallTypes.changeMallData,\r\n    payload: {\r\n        goodsList: []\r\n    }\r\n}\r\n\r\nclass SearchGoods extends React.Component<P> {\r\n    // 构造\r\n    constructor(props: any) {\r\n        super(props);\r\n        // 初始状态\r\n        this.state = {};\r\n    }\r\n\r\n    render(): React.ReactElement<any, string | React.JSXElementConstructor<any>> | string | number | {} | React.ReactNodeArray | React.ReactPortal | boolean | null | undefined {\r\n        const {\r\n            getList,\r\n            props: {\r\n                goodsTypes, goodsList, storeList,\r\n                formFields: {tabValue},\r\n                match: {params: {goodsType = 1}}\r\n            }\r\n        } = this\r\n        return <Flex direction={'column'} className={'search_list_page'}>\r\n            <div className={'search_fields'}>\r\n                <VsonField name={'content'} fieldType={'search'} defaultValue={''}\r\n                           placeholder='请输入搜索内容' props={{showCancelButton: true, onSubmit: getList}} />\r\n                <VsonTabs initValue={goodsType - 1} options={goodsTypes} onChange={getList} />\r\n            </div>\r\n            <Flex.Item className={tabValue === 4 ?'':'search_results'}>\r\n                <ScrollVertical onLoadData={getList} refreshOpt={refreshOpt}>\r\n                    {\r\n                        tabValue === 4 ? <StoreList list={storeList} /> :\r\n                            <GoodsList list={goodsList} type={tabValue || goodsType} />\r\n                    }\r\n                </ScrollVertical>\r\n            </Flex.Item>\r\n            <BackHome />\r\n        </Flex>;\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        const {\r\n            match: {params: {typeName, typeId, goodsType}},\r\n            goodsTypes,\r\n            formFields: {goodsCategory}\r\n        } = this.props\r\n        const shareData: any = {\r\n            title: (typeId ? typeName : goodsTypes[goodsType - 1].text) + \"搜索\"\r\n        }\r\n        if (!!typeId && !!typeName && goodsCategory.length === 2) {\r\n            shareData.imgUrl = goodsCategory[1].typeIco.medium\r\n        }\r\n        WxConfig.onShare(shareData)\r\n    }\r\n\r\n    getList = async (obj?: any, idx?: number) => {\r\n        const {\r\n            match: {params: {typeId, typeName, goodsType}},\r\n            formFields: {content, tabValue}, page, changeMallData,\r\n            goodsTypes, getGoodsList, getStoreList\r\n        } = this.props\r\n        document.title = (typeId ? typeName : goodsTypes[tabValue - 1].text) + \"搜索\"\r\n        if (!content) return\r\n        if (!!obj) {\r\n            await changeMallData({goodsList: [], storeList: []})\r\n        }\r\n        const params = {\r\n            url: goodsTypes[(tabValue || goodsType) - 1].seek,\r\n            data: {content, type: typeId, page}\r\n        }\r\n        tabValue === 4 ? await getStoreList(params) : await getGoodsList(params)\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps: Readonly<any>, nextState: Readonly<any>, nextContext: any): boolean {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: entries) {\r\n    const {goodsTypes, formFields, page} = state.commonReducer\r\n    const {goodsList, storeList} = state.mallReducer\r\n    return {\r\n        page,\r\n        goodsTypes: [...[...goodsTypes].splice(0, 3), {text: '店铺', value: 4, seek: '/seekStore'}],\r\n        formFields,\r\n        goodsList,\r\n        storeList\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any) {\r\n    const {getGoodsList, changeMallData, getStoreList} = mallActions\r\n    return {\r\n        ...bindActionCreators({getGoodsList, changeMallData, getStoreList}, dispatch),\r\n        dispatch\r\n    };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(SearchGoods)\r\n"],"sourceRoot":""}