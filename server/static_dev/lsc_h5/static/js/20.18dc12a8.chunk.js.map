{"version":3,"sources":["pages/museums/museum_edit/index.tsx"],"names":["MuseumEdit","props","onAdd","a","history","addMuseum","formFields","nature","type","territory","name","address","synopsis","logo","describe","imgs","linkman","wechat","phone","phone2","idNational","idHead","idHand","province","city","area","bool","params","fields","Object","entries","k","v","Utils","getDataType","length","fail","assign","isOk","success","goBack","state","this","museumNatures","className","museumTypes","museumScope","fieldType","options","splice","title","extra","Item","placeholder","lineImg","limit","src","alt","onClick","document","nextProps","nextState","nextContext","React","Component","connect","commonReducer","dispatch","museumActions","changeCommonData","commonActions","bindActionCreators"],"mappings":"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","file":"static/js/20.18dc12a8.chunk.js","sourcesContent":["import React from 'react'\r\nimport {bindActionCreators} from 'redux'\r\nimport {connect} from 'react-redux'\r\nimport {commonActions, museumActions} from 'action'\r\nimport {entries} from 'reducer'\r\nimport {AllowRight, VsonField, VsonUpload, AsyncPca} from 'components'\r\nimport {Flex, Toast} from 'antd-mobile'\r\nimport {Utils} from 'utils'\r\nimport './index.scss'\r\n\r\ninterface P {\r\n    className?: string,\r\n    history: any,\r\n    match: any,\r\n    addMuseum: any,\r\n    changeCommonData: any,\r\n    formFields: any,\r\n    museumNatures: any[],\r\n    museumTypes: any[],\r\n    museumScope: any[]\r\n}\r\n\r\ninterface S {\r\n}\r\n\r\nclass MuseumEdit extends React.Component<P, S> {\r\n    // 构造\r\n    constructor(props: any) {\r\n        super(props);\r\n        // 初始状态\r\n        this.state = {};\r\n    }\r\n\r\n    render(): React.ReactElement<any, string | React.JSXElementConstructor<any>> | string | number | {} | React.ReactNodeArray | React.ReactPortal | boolean | null | undefined {\r\n        const {\r\n            props: {\r\n                className = '',\r\n                museumNatures,\r\n                museumTypes,\r\n                museumScope\r\n            },\r\n            state: {},\r\n            onAdd\r\n        } = this\r\n        return (\r\n            <div className={`museum_edit_page`}>\r\n                <div className={'item base_info'}>\r\n                    <VsonField fieldType={'select'} name={'nature'} options={[...museumNatures].splice(1)}\r\n                               props={{title: '博物馆性质', extra: '请选择性质'}} />\r\n                    <VsonField className={'bd_ud'} fieldType={'select'} name={'type'} options={museumTypes}\r\n                               props={{title: '博物馆类型', extra: '请选择类型'}} />\r\n                    <Flex>\r\n                        <div className={'label'}>名称</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'name'} placeholder='不能使用他人注册商标' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <VsonField className={'bd_ud'} fieldType={'select'} name={'territory'} options={museumScope}\r\n                               props={{title: '地域范围', extra: '请选择地域范围'}} />\r\n                    <AsyncPca className={'bd_d'} props={{title: '区域选择', extra: '请选择所属区域'}} />\r\n                    <Flex>\r\n                        <div className={'label'}>详细地址</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'address'} placeholder='请输入详细地址' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <AllowRight className={'bd_ud'}>\r\n                        <Flex.Item>博物馆Logo</Flex.Item>\r\n                        <VsonUpload className={'logo'} name={'logo'} lineImg={1} />\r\n                    </AllowRight>\r\n                    <div className={'label'}>博物馆简介</div>\r\n                    <VsonField name={'synopsis'} fieldType={'textarea'} placeholder='请输入博物馆简介' />\r\n                    <div className={'label bd_u'}>一句话描述</div>\r\n                    <VsonField name={'describe'} fieldType={'textarea'} placeholder='请输入一句话描述' />\r\n                    <div className={'label bd_u'}>简介图片</div>\r\n                    <VsonUpload className={'imgs'} name={'imgs'} limit={9} />\r\n                </div>\r\n                <div className={'item'}>\r\n                    <Flex>\r\n                        <div className={'label'}>联系人</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'linkman'} placeholder='请输入联系人' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <Flex className={'bd_ud'}>\r\n                        <div className={'label'}>微信号</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'wechat'} placeholder='请输入微信号' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <Flex>\r\n                        <div className={'label'}>联系电话1</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'phone'} placeholder='请输入联系电话1' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <Flex className={'bd_u'}>\r\n                        <div className={'label'}>联系电话2</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'phone2'} placeholder='请输入联系电话2' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                </div>\r\n                <div className={'item certificate'}>\r\n                    <div className={'label'}>身份证头像照片</div>\r\n                    <div className={'tips'}>请用手机横向拍摄以保持图片正常显示</div>\r\n                    <Flex>\r\n                        <Flex.Item>\r\n                            <VsonUpload lineImg={1} name={'idHead'} />\r\n                        </Flex.Item>\r\n                        <Flex.Item>\r\n                            <img className={'example_img'} src=\"/lsc_h5/imgs/idcard_0.png\" alt=\"\" />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                </div>\r\n                <div className={'item certificate'}>\r\n                    <div className={'label'}>身份证国徽面照片</div>\r\n                    <div className={'tips'}>请用手机横向拍摄以保持图片正常显示</div>\r\n                    <Flex>\r\n                        <Flex.Item>\r\n                            <VsonUpload lineImg={1} name={'idNational'} />\r\n                        </Flex.Item>\r\n                        <Flex.Item>\r\n                            <img className={'example_img'} src=\"/lsc_h5/imgs/idcard_1.png\" alt=\"\" />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                </div>\r\n                <div className={'item certificate'}>\r\n                    <div className={'label'}>手持身份证照片</div>\r\n                    <div className={'tips'}>拍照时请对焦在身份证上(屏幕对着身份证按一下)</div>\r\n                    <Flex>\r\n                        <Flex.Item>\r\n                            <VsonUpload lineImg={1} name={'idHand'} />\r\n                        </Flex.Item>\r\n                        <Flex.Item>\r\n                            <img className={'example_img'} src=\"/lsc_h5/imgs/idcard_2.png\" alt=\"\" />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                </div>\r\n                <div onClick={onAdd} className={'state1'}>保存</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        document.title = '博物馆编辑'\r\n    }\r\n\r\n    onAdd = async () => {\r\n        const {\r\n            history,\r\n            addMuseum, formFields: {\r\n                nature, type, territory, name, address, synopsis, logo, describe, imgs,\r\n                linkman, wechat, phone, phone2, idNational, idHead, idHand, province, city, area\r\n            }\r\n        } = this.props\r\n        let bool: boolean = false\r\n        let params = {\r\n            nature,\r\n            type,\r\n            territory,\r\n            name,\r\n            address,\r\n            synopsis,\r\n            linkman,\r\n            wechat,\r\n            phone,\r\n            phone2,\r\n            logo,\r\n            idNational,\r\n            idHead,\r\n            idHand,\r\n            province,\r\n            city\r\n        }\r\n        const fields = Object.entries(params)\r\n        for (let [k, v] of fields) {\r\n            if ((v !== 0 && !v) || (Utils.getDataType(v) === 'Array' && !v.length)) {\r\n                Toast.fail(k + '不能为空！')\r\n                bool = true\r\n                break\r\n            }\r\n        }\r\n        if (bool) return\r\n        Object.assign(params, {describe, imgs, area})\r\n        params.logo = logo[0]\r\n        params.idHead = idHead[0]\r\n        params.idNational = idNational[0]\r\n        params.idHand = idHand[0]\r\n        const {isOk} = await addMuseum(params)\r\n        if (isOk) {\r\n            Toast.success('博物馆创建成功！')\r\n            history.goBack()\r\n        }\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps: Readonly<any>, nextState: Readonly<any>, nextContext: any): boolean {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: entries) {\r\n    const {formFields, museumNatures, museumTypes, museumScope} = state.commonReducer\r\n    return {\r\n        formFields, museumNatures, museumTypes, museumScope\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any) {\r\n    const {addMuseum} = museumActions\r\n    const {changeCommonData} = commonActions\r\n    return {\r\n        ...bindActionCreators({addMuseum, changeCommonData}, dispatch),\r\n        dispatch\r\n    };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MuseumEdit)\r\n"],"sourceRoot":""}
