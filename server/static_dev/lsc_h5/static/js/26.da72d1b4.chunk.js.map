{"version":3,"sources":["pages/museums/museum_type_edit/index.tsx"],"names":["MuseumTypeEdit","props","getInit","a","getMuseumTypeDetail","formFields","changeMuseumData","changeCommonData","match","params","opr","id","name","img","Object","assign","museumType","onSave","history","addMuseumType","updateMuseumType","ps","museumId","isOk","success","goBack","state","this","className","direction","Item","placeholder","lineImg","onClick","document","title","nextProps","nextState","nextContext","React","Component","connect","museumReducer","commonReducer","dispatch","museumActions","commonActions","bindActionCreators"],"mappings":"sWAyBMA,E,keAEF,WAAYC,GAAa,IAAD,8BACpB,cAAMA,IAqCVC,QAtCwB,sBAsCd,gDAAAC,EAAA,2DACoG,EAAKF,MAAxGG,EADD,EACCA,oBAAqBC,EADtB,EACsBA,WAAYC,EADlC,EACkCA,iBAAkBC,EADpD,EACoDA,iBADpD,IACsEC,MAAQC,OAASC,EADvF,EACuFA,IAAKC,EAD5F,EAC4FA,GACtF,SAARD,EAFE,iCAGwBN,EAAoBO,GAH5C,gBAGKC,EAHL,EAGKA,KAAMC,EAHX,EAGWA,IACbC,OAAOC,OAAOV,EAAY,CAACO,OAAMC,IAAKA,EAAM,CAACA,GAAO,KAJlD,yCAMIP,EAAiB,CAACU,WAAY,KANlC,QAOFF,OAAOC,OAAOV,EAAY,CAACO,KAAM,GAAIC,IAAK,KAPxC,yBASAN,EAAiB,CAACF,WAAW,eAAKA,KATlC,4CAtCc,EAkDxBY,OAlDwB,sBAkDf,kDAAAd,EAAA,2DACmG,EAAKF,MADxG,IACEI,WAAaO,EADf,EACeA,KAAMC,EADrB,EACqBA,IAAMK,EAD3B,EAC2BA,QAD3B,IACoCV,MAAQC,OAASC,EADrD,EACqDA,IAAKC,EAD1D,EAC0DA,GAAMQ,EADhE,EACgEA,cAAeC,EAD/E,EAC+EA,iBAChFC,EAAK,CAACT,OAAMC,IAAKA,EAAI,IACzBC,OAAOC,OAAOM,EAAY,QAARX,EAAgB,CAACY,SAAUX,GAAM,CAACA,OAC7B,QAARD,EAJV,gCAIgCS,EAAcE,GAJ9C,2DAI0DD,EAAiBC,GAJ3E,qCAIEE,OAEH,IAAMC,SAAiB,QAARd,EAAgB,eAAO,gBAAQ,6BAC9CQ,EAAQO,UAPP,4CA/CL,EAAKC,MAAQ,GAHO,E,qDAMqJ,IAAD,EAQpKC,KANA1B,MAFoK,KAGhK2B,UAHgK,EAIhKpB,MAAQC,QAASC,EAJ+I,EAI/IA,IAJ+I,EAI1IC,GAJ0I,YAQpKgB,KAFAD,OANoK,IAOpKT,EACAU,KADAV,OAEJ,OACI,uBAAMW,UAAS,wBAA2BC,UAAW,UACjD,yBAAKD,UAAW,QACZ,2BACI,yBAAKA,UAAW,SAAhB,4BACA,sBAAME,KAAN,KACI,kBAAC,IAAD,CAAWlB,KAAM,OAAQmB,YAAY,iDAG7C,yBAAKH,UAAW,cAAhB,4BACA,kBAAC,IAAD,CAAYhB,KAAM,MAAOoB,QAAS,IAClC,yBAAKJ,UAAW,QAAhB,4CAEJ,yBAAKK,QAAShB,EAAQW,UAAW,UAAmB,QAARlB,EAAgB,eAAO,mB,0CAM3EwB,SAASC,MAAQ,2BACjBR,KAAKzB,Y,4CA2BakC,EAA0BC,EAA0BC,GACtE,OAAO,M,GAjEcC,IAAMC,WA6FpBC,uBAxBf,SAAyBf,GAAiB,IAC/BV,EAAcU,EAAMgB,cAApB1B,WAEP,MAAO,CACHX,WAFiBqB,EAAMiB,cAApBtC,WAGHW,iBAIR,SAA4B4B,GAAgB,IACjCxC,EAA0EyC,IAA1EzC,oBAAqBE,EAAqDuC,IAArDvC,iBAAkBa,EAAmC0B,IAAnC1B,cAAeC,EAAoByB,IAApBzB,iBACtDb,EAAoBuC,IAApBvC,iBACP,OAAO,2BACAwC,6BAAmB,CAClB3C,sBACAE,mBACAC,mBACAY,gBACAC,oBACDwB,IAPP,IAQIA,eAIOH,CAGbzC","file":"static/js/26.da72d1b4.chunk.js","sourcesContent":["import React from 'react'\r\nimport './index.scss'\r\nimport {entries} from \"reducer\";\r\nimport {museumActions, commonActions} from \"action\";\r\nimport {bindActionCreators} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {VsonUpload, VsonField} from 'components'\r\nimport {Flex, Toast} from 'antd-mobile'\r\n\r\ninterface P {\r\n    className?: string,\r\n    match: any,\r\n    history: any,\r\n    getMuseumTypeDetail: any,\r\n    changeMuseumData: any,\r\n    changeCommonData: any,\r\n    addMuseumType: any,\r\n    updateMuseumType: any,\r\n    museumType: any,\r\n    formFields: any\r\n}\r\n\r\ninterface S {\r\n}\r\n\r\nclass MuseumTypeEdit extends React.Component<P, S> {\r\n    // 构造\r\n    constructor(props: any) {\r\n        super(props);\r\n        // 初始状态\r\n        this.state = {};\r\n    }\r\n\r\n    render(): React.ReactElement<any, string | React.JSXElementConstructor<any>> | string | number | {} | React.ReactNodeArray | React.ReactPortal | boolean | null | undefined {\r\n        const {\r\n            props: {\r\n                className = '',\r\n                match: {params: {opr, id}}\r\n            },\r\n            state: {},\r\n            onSave\r\n        } = this\r\n        return (\r\n            <Flex className={`museum_type_edit_page`} direction={\"column\"}>\r\n                <div className={'item'}>\r\n                    <Flex>\r\n                        <div className={'label'}>类目名称</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'name'} placeholder='请输入类目名称' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <div className={'label bd_u'}>图片简介</div>\r\n                    <VsonUpload name={'img'} lineImg={1} />\r\n                    <div className={'tips'}>推荐长宽比：2:1</div>\r\n                </div>\r\n                <div onClick={onSave} className={'state7'}>{opr === 'add' ? '添加' : '保存'}</div>\r\n            </Flex>\r\n        );\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        document.title = '类目编辑'\r\n        this.getInit()\r\n    }\r\n\r\n    getInit = async () => {\r\n        const {getMuseumTypeDetail, formFields, changeMuseumData, changeCommonData, match: {params: {opr, id}}} = this.props\r\n        if (opr === 'edit') {\r\n            const {name, img} = await getMuseumTypeDetail(id)\r\n            Object.assign(formFields, {name, img: img ? [img] : []})\r\n        } else {\r\n            await changeMuseumData({museumType: {}})\r\n            Object.assign(formFields, {name: '', img: []})\r\n        }\r\n        await changeCommonData({formFields: {...formFields}})\r\n    }\r\n\r\n    onSave = async () => {\r\n        const {formFields: {name, img}, history, match: {params: {opr, id}}, addMuseumType, updateMuseumType} = this.props\r\n        let ps = {name, img: img[0]}\r\n        Object.assign(ps, opr === 'add' ? {museumId: id} : {id})\r\n        const {isOk} = opr === 'add' ? await addMuseumType(ps) : await updateMuseumType(ps)\r\n        if (isOk) {\r\n            Toast.success((opr === 'add' ? '创建' : \"修改\") + '类目成功!')\r\n            history.goBack()\r\n        }\r\n    }\r\n\r\n\r\n    shouldComponentUpdate(nextProps: Readonly<any>, nextState: Readonly<any>, nextContext: any): boolean {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: entries) {\r\n    const {museumType} = state.museumReducer\r\n    const {formFields} = state.commonReducer\r\n    return {\r\n        formFields,\r\n        museumType\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any) {\r\n    const {getMuseumTypeDetail, changeMuseumData, addMuseumType, updateMuseumType} = museumActions\r\n    const {changeCommonData} = commonActions\r\n    return {\r\n        ...bindActionCreators({\r\n            getMuseumTypeDetail,\r\n            changeMuseumData,\r\n            changeCommonData,\r\n            addMuseumType,\r\n            updateMuseumType\r\n        }, dispatch),\r\n        dispatch\r\n    };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MuseumTypeEdit)\r\n\r\n"],"sourceRoot":""}