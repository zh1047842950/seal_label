{"version":3,"sources":["../node_modules/antd-mobile/es/wing-blank/index.js","pages/mall/goods_list/index.tsx"],"names":["_React$Component","WingBlank","this","__proto__","Object","getPrototypeOf","apply","arguments","key","value","_props","props","prefixCls","size","className","children","style","wrapCls","defaultProps","refreshOpts","type","mallTypes","changeMallData","payload","goodsList","tabsProps","label","GoodsList","getInitData","a","getGoodsCategories","changeCommonData","formFields","goodsCategories","arr","typeName","typeId","goodsCategory","getList","obj","index","page","goodsTypes","match","params","getGoodsList","sort","numRange","p","totalPage","url","api","data","bottomPrice","peakPrice","state","sortRules","direction","Item","navData","to","pathname","name","options","onChange","onLoadData","square","list","WxConfig","onShare","title","text","nextProps","nextState","nextContext","React","Component","connect","commonReducer","mallReducer","dispatch","mallActions","commonActions","bindActionCreators"],"mappings":"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","file":"static/js/5.16d1c188.chunk.js","sourcesContent":["import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport classnames from 'classnames';\nimport * as React from 'react';\n\nvar WingBlank = function (_React$Component) {\n  _inherits(WingBlank, _React$Component);\n\n  function WingBlank() {\n    _classCallCheck(this, WingBlank);\n\n    return _possibleConstructorReturn(this, (WingBlank.__proto__ || Object.getPrototypeOf(WingBlank)).apply(this, arguments));\n  }\n\n  _createClass(WingBlank, [{\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          prefixCls = _props.prefixCls,\n          size = _props.size,\n          className = _props.className,\n          children = _props.children,\n          style = _props.style;\n      var wrapCls = classnames(prefixCls, prefixCls + '-' + size, className);\n      return React.createElement('div', {\n        className: wrapCls,\n        style: style\n      }, children);\n    }\n  }]);\n\n  return WingBlank;\n}(React.Component);\n\nexport default WingBlank;\nWingBlank.defaultProps = {\n  prefixCls: 'am-wingblank',\n  size: 'lg'\n};","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\nimport {bindActionCreators} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {WingBlank, Flex} from 'antd-mobile'\r\nimport {commonActions, mallActions,mallTypes} from \"action\"\r\nimport {entries} from 'reducer'\r\nimport {WxConfig} from 'utils'\r\nimport {VsonTabs, VsonRange, GoodsList as GoodsListView, ScrollVertical, SearchNav, BackHome} from \"components\"\r\n\r\nimport './index.scss'\r\n\r\nexport interface P {\r\n    numRange: number[],\r\n    page: number,\r\n    formFields: any,\r\n    changeMallData: any,\r\n    changeCommonData: any,\r\n    getGoodsCategories: any,\r\n    getGoodsList: any,\r\n    goodsList: any[],\r\n    match: any,\r\n    goodsTypes: any[],\r\n    goodsCategories: any[],\r\n    sortRules: any[]\r\n}\r\n\r\nconst refreshOpts = [{\r\n    type: mallTypes.changeMallData,\r\n    payload: {\r\n        goodsList: []\r\n    }\r\n}]\r\nconst tabsProps = {\r\n    label: 'typeName',\r\n    value: 'typeId'\r\n}\r\n\r\nclass GoodsList extends React.Component<P> {\r\n    // 构造\r\n    constructor(props: any) {\r\n        super(props);\r\n        // 初始状态\r\n        this.state = {};\r\n    }\r\n\r\n    render(): React.ReactElement<any, string | React.JSXElementConstructor<any>> | string | number | {} | React.ReactNodeArray | React.ReactPortal | boolean | null | undefined {\r\n        const {\r\n            getList, props: {\r\n                goodsCategories, sortRules, goodsList, formFields: {goodsCategory, typeName},\r\n                match: {params: {type}}\r\n            }\r\n        } = this\r\n        return (\r\n            <Flex direction={'column'} className={'goods_list_page'}>\r\n                <Flex className={'search_type'}>\r\n                    <Flex.Item>\r\n                        <WingBlank size=\"sm\">\r\n                            <SearchNav navData={!!goodsCategory ? [type, goodsCategory, typeName] : [type]} />\r\n                        </WingBlank>\r\n                    </Flex.Item>\r\n                    <Link to={{pathname: '/mall/goods_types/' + type}}>分类</Link>\r\n                </Flex>\r\n                <VsonTabs name={'goodsCategory'} options={goodsCategories} tabsProps={tabsProps} onChange={getList} />\r\n                <VsonTabs name={'sort'} options={sortRules} page={6} onChange={getList} />\r\n                <WingBlank size=\"lg\" className={'price_range'}>\r\n                    <Flex>\r\n                        <p>价格范围</p>\r\n                        <Flex.Item>\r\n                            <VsonRange onChange={getList} />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                </WingBlank>\r\n                <Flex.Item className={'box'}>\r\n                    <ScrollVertical onLoadData={getList} refreshOpts={refreshOpts}>\r\n                        <GoodsListView square={true} list={goodsList} type={type} />\r\n                    </ScrollVertical>\r\n                </Flex.Item>\r\n                <BackHome />\r\n            </Flex>\r\n        );\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        const {goodsTypes, match: {params: {type}}, changeMallData} = this.props\r\n        WxConfig.onShare({title: goodsTypes[type - 1].text})\r\n        changeMallData({goodsList: []})\r\n        this.getInitData()\r\n    }\r\n\r\n    getInitData = async () => {\r\n        const {getGoodsCategories, changeCommonData, formFields} = this.props\r\n        const {goodsCategories} = await getGoodsCategories()\r\n        const arr = [{\r\n            typeName: '全部',\r\n            typeId: ''\r\n        }, ...goodsCategories]\r\n        formFields.goodsCategory = ''\r\n        formFields.typeName = '全部'\r\n        await changeCommonData({goodsCategories: arr, formFields: {...formFields}})\r\n        this.getList()\r\n    }\r\n\r\n    getList = async (obj?: any, index?: number) => {\r\n        const {page, formFields, goodsTypes, match: {params: {type}}, getGoodsList, changeCommonData} = this.props\r\n        const {goodsCategory, sort = 0, numRange = []} = formFields\r\n        let p: any = {}\r\n\r\n        if (obj && obj.typeName) {\r\n            formFields.typeName = obj.typeName\r\n            p = await changeCommonData({formFields: {...formFields}, page: 1, totalPage: 0})\r\n        }\r\n\r\n        await getGoodsList({\r\n            url: goodsTypes[type - 1].api,\r\n            data: {\r\n                type: goodsCategory,\r\n                page: p.page || page, sort,\r\n                bottomPrice: numRange[0],\r\n                peakPrice: numRange[1]\r\n            }\r\n        })\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps: Readonly<any>, nextState: Readonly<any>, nextContext: any): boolean {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: entries) {\r\n    const {goodsCategories, goodsTypes, page, totalPage, sortRules, formFields} = state.commonReducer\r\n    const {goodsList} = state.mallReducer\r\n    return {\r\n        sortRules,\r\n        page,\r\n        formFields,\r\n        totalPage,\r\n        goodsTypes,\r\n        goodsList,\r\n        goodsCategories\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any) {\r\n    const {getGoodsList, changeMallData} = mallActions\r\n    const {getGoodsCategories, changeCommonData} = commonActions\r\n    return {\r\n        ...bindActionCreators({getGoodsList, changeMallData, getGoodsCategories, changeCommonData}, dispatch),\r\n        dispatch\r\n    };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(GoodsList)\r\n"],"sourceRoot":""}