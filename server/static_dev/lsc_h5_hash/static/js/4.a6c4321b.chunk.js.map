{"version":3,"sources":["../node_modules/antd-mobile/es/progress/index.js","pages/mall/crowd_funding_detail/index.tsx"],"names":["_React$Component","Progress","this","__proto__","Object","getPrototypeOf","apply","arguments","key","value","noAppearTransition","_this2","props","appearTransition","setTimeout","barRef","style","width","percent","_classnames","_this3","_props","className","prefixCls","position","unfilled","_props$style","undefined","_props$barStyle","barStyle","percentStyle","height","wrapCls","role","ref","el","defaultProps","topTabs","text","CrowdFundingDetail","nodeHeights","onTopTabChange","option","index","document","getElementsByClassName","scrollTop","getInitData","newId","a","getGoodsDetail","shopId","match","params","getComments","shopName","storeId","page","getNodeHeights","offsetTop","onScroll","e","scrollHeight","clientHeight","tab","changeCommonData","opacity","setState","tabValue","state","goods","storeInfo","tariff","direction","Item","options","onChange","src","alt","onClick","Dialog","showDownloadModal","shopPriImg","minPrice","id","shopCode","type","parseInt","isFavorite","explain","store","alreadyPrice","supporter","targetPrice","leftDay","leftHour","shopOriginalCost","map","i","str","price","name","fieldType","min","defaultValue","hasBottom","title","nextProps","nextState","nextContext","prevProps","prevState","snapshot","React","Component","connect","mallReducer","commonReducer","comments","dispatch","mallActions","getAuctionScenes","commonActions","bindActionCreators"],"mappings":"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","file":"static/js/4.a6c4321b.chunk.js","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport classnames from 'classnames';\nimport * as React from 'react';\n\nvar Progress = function (_React$Component) {\n  _inherits(Progress, _React$Component);\n\n  function Progress() {\n    _classCallCheck(this, Progress);\n\n    return _possibleConstructorReturn(this, (Progress.__proto__ || Object.getPrototypeOf(Progress)).apply(this, arguments));\n  }\n\n  _createClass(Progress, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps() {\n      this.noAppearTransition = true;\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.props.appearTransition) {\n        setTimeout(function () {\n          if (_this2.barRef) {\n            _this2.barRef.style.width = _this2.props.percent + '%';\n          }\n        }, 10);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _classnames,\n          _this3 = this;\n\n      var _props = this.props,\n          className = _props.className,\n          prefixCls = _props.prefixCls,\n          position = _props.position,\n          unfilled = _props.unfilled,\n          _props$style = _props.style,\n          style = _props$style === undefined ? {} : _props$style,\n          _props$barStyle = _props.barStyle,\n          barStyle = _props$barStyle === undefined ? {} : _props$barStyle;\n      var percentStyle = {\n        width: this.noAppearTransition || !this.props.appearTransition ? this.props.percent + '%' : 0,\n        height: 0\n      };\n      var wrapCls = classnames(prefixCls + '-outer', className, (_classnames = {}, _defineProperty(_classnames, prefixCls + '-fixed-outer', position === 'fixed'), _defineProperty(_classnames, prefixCls + '-hide-outer', !unfilled), _classnames));\n      return React.createElement('div', {\n        style: style,\n        className: wrapCls,\n        role: 'progressbar',\n        'aria-valuenow': this.props.percent,\n        'aria-valuemin': 0,\n        'aria-valuemax': 100\n      }, React.createElement('div', {\n        ref: function ref(el) {\n          return _this3.barRef = el;\n        },\n        className: prefixCls + '-bar',\n        style: _extends({}, barStyle, percentStyle)\n      }));\n    }\n  }]);\n\n  return Progress;\n}(React.Component);\n\nexport default Progress;\nProgress.defaultProps = {\n  prefixCls: 'am-progress',\n  percent: 0,\n  position: 'fixed',\n  unfilled: true,\n  appearTransition: false\n};","import React from 'react'\r\nimport {entries} from \"reducer\";\r\nimport {mallActions, commonActions} from \"action\";\r\nimport {bindActionCreators} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    VsonTabs,\r\n    ScrollVertical,\r\n    VsonBanner,\r\n    CollectionGoods,\r\n    StoreTop,\r\n    StoreGoods,\r\n    GoodsDetail,\r\n    BuyGoodsBottom,\r\n    VsonField,\r\n    BackHome\r\n} from 'components'\r\nimport {Dialog} from 'utils'\r\nimport {Flex, Progress} from 'antd-mobile'\r\nimport './index.scss'\r\n\r\nexport interface P {\r\n    changeCommonData: any,\r\n    getGoodsDetail: any,\r\n    getComments: any,\r\n    storeInfo: any,\r\n    goods: any,\r\n    comments: any[],\r\n    match: any\r\n}\r\n\r\nconst topTabs: any[] = [\r\n    {text: '商品', value: 1},\r\n    {text: '详情', value: 2},\r\n    // {text: '评价', value: 3}\r\n]\r\n\r\nexport interface S {\r\n    opacity: number,\r\n    tabValue: number\r\n}\r\n\r\nclass CrowdFundingDetail extends React.Component<P, S> {\r\n    private nodeHeights: any[] = []\r\n\r\n    // 构造\r\n    constructor(props: any) {\r\n        super(props);\r\n        // 初始状态\r\n        this.state = {\r\n            opacity: 0,\r\n            tabValue: 0\r\n        };\r\n    }\r\n\r\n    render(): React.ReactElement<any, string | React.JSXElementConstructor<any>> | string | number | {} | React.ReactNodeArray | React.ReactPortal | boolean | null | undefined {\r\n        const {\r\n            props: {goods, storeInfo},\r\n            state: {opacity, tabValue},\r\n            onScroll,\r\n            onTopTabChange\r\n        } = this\r\n        const {tariff = []} = goods\r\n        return (\r\n            <Flex direction={\"column\"} className={'crowd_funding_detail bg1'}>\r\n                {/*<BackHome className={`home ${!(opacity < 1) ? 'white' : ''}`} />*/}\r\n                <Flex.Item>\r\n                    <ScrollVertical onScroll={onScroll}>\r\n                        <Flex className={'top_tab padding_lr bd_d item'} style={{opacity: opacity}}>\r\n                            <Flex.Item>\r\n                                <VsonTabs options={topTabs} value={tabValue} onChange={onTopTabChange} />\r\n                            </Flex.Item>\r\n                            <img src=\"/lsc_h5_hash/imgs/msg_0.png\" alt=\"\" onClick={Dialog.showDownloadModal} />\r\n                        </Flex>\r\n                        <VsonBanner options={goods.shopPriImg} />\r\n                        <div className={'info item padding'}>\r\n                            <Flex>\r\n                                <Flex.Item>\r\n                                    <span className={'price1'}>￥{goods.minPrice}</span>起\r\n                                </Flex.Item>\r\n                                <CollectionGoods id={goods.shopCode} type={4} state={parseInt(goods.isFavorite)} />\r\n                            </Flex>\r\n                            <div className={'title'}>{goods.shopName}</div>\r\n                            <div className={'explain '}>{goods.explain}</div>\r\n                            <StoreTop className={'bd_u margin_u'} store={storeInfo} />\r\n                        </div>\r\n                        <div className={'item crowd_funding'}>\r\n                            <div className={'total'}>已筹到￥{goods.alreadyPrice}</div>\r\n                            <Progress className={'crowd_progress'} position={\"normal\"} percent={goods.percent} />\r\n                            <Flex>\r\n                                <Flex.Item className={'blue'}>当前进度:{goods.percent}%</Flex.Item>\r\n                                <span>{goods.supporter}名支持者</span>\r\n                            </Flex>\r\n                            <Flex>\r\n                                (众筹目标金额：<span className={'price1'}>{goods.targetPrice} </span> 剩余时间：\r\n                                {!!goods.leftDay && <div><span className={'price1'}>{goods.leftDay}</span>天</div>}\r\n                                {!!goods.leftHour && <div><span className={'price1'}>{goods.leftHour}</span>小时</div>}\r\n                                )\r\n                            </Flex>\r\n                            <Flex>\r\n                                <Flex.Item>商品原价:<span\r\n                                    className={'price1'}>{goods.shopOriginalCost}</span> 元/件</Flex.Item>\r\n                                众筹价：<span className={'price1'}>{goods.minPrice} </span> 元/件起\r\n                            </Flex>\r\n                            <Flex className={'tariff_row bd_ud'}>\r\n                                <div className={'tariff_num bd_lr'}>序号</div>\r\n                                <Flex.Item>购买数量</Flex.Item>\r\n                                <div className={'tariff_price bd_lr'}>单价(元)</div>\r\n                            </Flex>\r\n                            {\r\n                                tariff.map((e: any, i: number) => <Flex key={i} className={'tariff_row bd_d'}>\r\n                                    <div className={'tariff_num bd_lr'}>{i + 1}</div>\r\n                                    <Flex.Item className={''}>{e.str}</Flex.Item>\r\n                                    <div className={'tariff_price bd_lr'}>{e.price}</div>\r\n                                </Flex>)\r\n                            }\r\n                        </div>\r\n                        <Flex className={'goods_num item padding margin_u bd_d'}>\r\n                            <Flex.Item>数量</Flex.Item>\r\n                            <VsonField name={'num'} className={'num '} fieldType={'stepper'}\r\n                                       props={{min: 1}} defaultValue={1} />\r\n                        </Flex>\r\n                        <GoodsDetail goods={goods} className={''} type={3} />\r\n                        <StoreGoods className={'margin_u'} id={goods.storeId} />\r\n                    </ScrollVertical>\r\n                </Flex.Item>\r\n                <BuyGoodsBottom />\r\n                <BackHome hasBottom={true} />\r\n            </Flex>\r\n        );\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        document.title = '众筹商品详情'\r\n        this.nodeHeights = []\r\n        this.getInitData()\r\n    }\r\n\r\n    onTopTabChange = (option: any, index: number) => {\r\n        document.getElementsByClassName('tloader')[0].scrollTop = this.nodeHeights[index]\r\n    }\r\n\r\n    getInitData = async (newId?: string) => {\r\n        const {\r\n            getGoodsDetail, match: {params: {shopId}},\r\n            getComments\r\n        } = this.props\r\n        const {shopName, storeId} = await getGoodsDetail(newId || shopId, 4, !!newId)\r\n        await getComments({storeId, page: 1})\r\n    }\r\n\r\n    getNodeHeights = () => {\r\n        this.nodeHeights = [\r\n            0,\r\n            // @ts-ignore\r\n            document.getElementsByClassName('goods_detail_component')[0].offsetTop,\r\n        ]\r\n    }\r\n\r\n    onScroll = (e: any) => {\r\n        const {scrollTop, scrollHeight, clientHeight} = e\r\n        // this.getNodeHeights()\r\n        const {nodeHeights, props: {changeCommonData}} = this\r\n        let tab = 0;\r\n        let opacity = 1\r\n        switch (true) {\r\n            case scrollTop < 201 || scrollTop < nodeHeights[1]:\r\n                opacity = scrollTop / 200\r\n                break;\r\n            default:\r\n                tab = 1\r\n                break;\r\n        }\r\n        this.setState({tabValue: tab, opacity})\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps: Readonly<any>, nextState: Readonly<any>, nextContext: any): boolean {\r\n        return true\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Readonly<P>, prevState: Readonly<S>, snapshot?: any): void {\r\n        this.getNodeHeights()\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps: Readonly<P>, nextContext: any): void {\r\n        const {match: {params: {shopId: newId}}} = nextProps\r\n        const {match: {params: {shopId}}} = this.props\r\n        if (newId !== shopId) {\r\n            this.getInitData(newId)\r\n        }\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: entries) {\r\n    const {goods} = state.mallReducer\r\n    const {storeInfo, comments} = state.commonReducer\r\n    return {\r\n        goods,\r\n        storeInfo,\r\n        comments\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any) {\r\n    const {getGoodsDetail, getAuctionScenes} = mallActions\r\n    const {changeCommonData, getComments} = commonActions\r\n    return {\r\n        ...bindActionCreators({\r\n            getGoodsDetail,\r\n            changeCommonData,\r\n            getAuctionScenes,\r\n            getComments\r\n        }, dispatch),\r\n        dispatch\r\n    };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(CrowdFundingDetail)\r\n\r\n\r\n"],"sourceRoot":""}