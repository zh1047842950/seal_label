{"version":3,"sources":["pages/museums/museum_subtype_edit/index.tsx"],"names":["MuseumSubTypeEdit","props","getInit","a","getMuseumSubTypeDetail","formFields","changeMuseumData","changeCommonData","match","params","museumId","id","name","img","describe","mapImg","Object","assign","museumSubType","onSave","history","addMuseumSubType","updateMuseumSubType","ps","stairOneId","isOk","success","goBack","state","this","className","Item","placeholder","lineImg","fieldType","onClick","document","title","nextProps","nextState","nextContext","React","Component","connect","museumReducer","commonReducer","dispatch","museumActions","commonActions","bindActionCreators"],"mappings":"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","file":"static/js/24.6fe4aa7a.chunk.js","sourcesContent":["import React from 'react'\r\nimport './index.scss'\r\nimport {entries} from \"reducer\";\r\nimport {museumActions, commonActions} from \"action\";\r\nimport {bindActionCreators} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {VsonUpload, VsonField} from 'components'\r\nimport {Flex, Toast} from 'antd-mobile'\r\n\r\ninterface P {\r\n    className?: string,\r\n    match: any,\r\n    history: any,\r\n    getMuseumSubTypeDetail: any,\r\n    changeMuseumData: any,\r\n    changeCommonData: any,\r\n    addMuseumSubType: any,\r\n    updateMuseumSubType: any,\r\n    museumSubType: any,\r\n    formFields: any\r\n}\r\n\r\ninterface S {\r\n}\r\n\r\nclass MuseumSubTypeEdit extends React.Component<P, S> {\r\n    // 构造\r\n    constructor(props: any) {\r\n        super(props);\r\n        // 初始状态\r\n        this.state = {};\r\n    }\r\n\r\n    render(): React.ReactElement<any, string | React.JSXElementConstructor<any>> | string | number | {} | React.ReactNodeArray | React.ReactPortal | boolean | null | undefined {\r\n        const {\r\n            props: {\r\n                className = '',\r\n                match: {params: {museumId, id}}\r\n            },\r\n            state: {},\r\n            onSave\r\n        } = this\r\n        return (\r\n            <div className={`museum_subtype_edit_page`} >\r\n                <div className={'item'}>\r\n                    <Flex>\r\n                        <div className={'label'}>类目名称</div>\r\n                        <Flex.Item>\r\n                            <VsonField name={'name'} placeholder='请输入类目名称' />\r\n                        </Flex.Item>\r\n                    </Flex>\r\n                    <div className={'label bd_u'}>图片简介</div>\r\n                    <VsonUpload name={'img'} lineImg={1} />\r\n                    <div className={'tips'}>推荐长宽比：2:1</div>\r\n                </div>\r\n                <div className={'item '}>\r\n                    <div className={'label '}>区域描述</div>\r\n                    <VsonField className={'bd_ud'} fieldType={'textarea'} name={'describe'} placeholder='请输入区域描述' />\r\n                    <VsonUpload className={' padding_d'} name={'mapImg'} lineImg={1} />\r\n                </div>\r\n                <div onClick={onSave} className={'state7'}>{!!museumId ? '添加' : '保存'}</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        document.title = '二级类目编辑'\r\n        this.getInit()\r\n    }\r\n\r\n    getInit = async () => {\r\n        const {getMuseumSubTypeDetail, formFields, changeMuseumData, changeCommonData, match: {params: {museumId, id}}} = this.props\r\n        if (!museumId) {\r\n            const {name, img, describe, mapImg} = await getMuseumSubTypeDetail(id)\r\n            Object.assign(formFields, {name, img: img ? [img] : [], mapImg: mapImg ? [mapImg] : [], describe})\r\n        } else {\r\n            await changeMuseumData({museumSubType: {}})\r\n            Object.assign(formFields, {name: '', img: [], mapImg: [], describe: ''})\r\n        }\r\n        await changeCommonData({formFields: {...formFields}})\r\n    }\r\n\r\n    onSave = async () => {\r\n        const {formFields: {name, img, mapImg, describe}, history, match: {params: {museumId, id}}, addMuseumSubType, updateMuseumSubType} = this.props\r\n        let ps = {name, img: img[0], mapImg: mapImg[0], describe}\r\n        Object.assign(ps, !!museumId ? {museumId, stairOneId: id} : {id})\r\n        const {isOk} = !!museumId ? await addMuseumSubType(ps) : await updateMuseumSubType(ps)\r\n        if (isOk) {\r\n            Toast.success((!!museumId ? '创建' : \"修改\") + '二级类目成功!')\r\n            history.goBack()\r\n        }\r\n    }\r\n\r\n\r\n    shouldComponentUpdate(nextProps: Readonly<any>, nextState: Readonly<any>, nextContext: any): boolean {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state: entries) {\r\n    const {museumSubType} = state.museumReducer\r\n    const {formFields} = state.commonReducer\r\n    return {\r\n        formFields,\r\n        museumSubType\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any) {\r\n    const {getMuseumSubTypeDetail, changeMuseumData, addMuseumSubType, updateMuseumSubType} = museumActions\r\n    const {changeCommonData} = commonActions\r\n    return {\r\n        ...bindActionCreators({\r\n            getMuseumSubTypeDetail,\r\n            changeMuseumData,\r\n            changeCommonData,\r\n            addMuseumSubType,\r\n            updateMuseumSubType\r\n        }, dispatch),\r\n        dispatch\r\n    };\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MuseumSubTypeEdit)\r\n\r\n"],"sourceRoot":""}